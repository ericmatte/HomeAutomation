- id: '1663895419097'
  alias: Hue remote
  description: ''
  use_blueprint:
    path: ericmatte/philips_hue_v2_smart_dimmer_switch.yaml
    input:
      hue_device: eba9d8b4257ce13c892979b9e850a7fb
      Power_Press:
      - choose:
        - conditions:
          - condition: state
            entity_id: light.bedroom_2
            state: 'off'
          sequence:
          - action: hue.activate_scene
            metadata: {}
            data:
              transition: 1
              dynamic: true
            target:
              entity_id: scene.bedroom_natural_light
        default:
        - action: light.turn_off
          metadata: {}
          data:
            transition: 2
          target:
            entity_id: light.bedroom_2
      Up_Press:
      - action: light.turn_on
        metadata: {}
        data:
          transition: 1
          brightness_pct: 100
        target:
          area_id: bedroom
      Down_Press:
      - action: light.turn_on
        metadata: {}
        data:
          transition: 1
          brightness_step_pct: -25
        target:
          area_id: bedroom
      Hue_Press:
      - action: cover.toggle
        metadata: {}
        data: {}
        target:
          area_id: bedroom
      Down_Short_Release: []
      Down_Repeat: []
      Up_Short_Release: []
      Up_Repeat: []
- id: '1754669505325'
  alias: Hue remote
  description: ''
  use_blueprint:
    path: ericmatte/philips_hue_v2_smart_dimmer_switch.yaml
    input:
      hue_device: e94cf02d004ef2682f3d97632158391f
      Power_Press:
      - action: light.turn_on
        metadata: {}
        data: {}
        target:
          area_id:
          - theatre
      Up_Press: []
      Down_Press: []
      Hue_Press:
      - action: light.turn_off
        metadata: {}
        data: {}
        target:
          area_id:
          - theatre
      Down_Short_Release: []
      Down_Repeat:
      - action: light.turn_on
        metadata: {}
        data:
          brightness_step_pct: -5
        target:
          area_id:
          - theatre
      Up_Short_Release: []
      Up_Repeat:
      - action: light.turn_on
        metadata: {}
        data:
          brightness_step_pct: 5
        target:
          area_id: theatre
- id: '1754713870026'
  alias: Turn off all when going to bed
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - sensor.eric_phone_battery_state
    to: charging
    id: charger
  - trigger: state
    entity_id:
    - light.bedroom_2
    to: 'off'
    id: lights_off
  conditions:
  - condition: time
    after: '22:00:00'
    before: 02:00:00
  - condition: state
    entity_id: sensor.eric_phone_battery_state
    state: charging
  - condition: or
    conditions:
    - condition: state
      entity_id: light.bedroom_2
      state: 'off'
    - condition: numeric_state
      entity_id: light.eric_bedside_table
      attribute: brightness
      above: 0
      below: 5
  actions:
  - action: script.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: script.turn_off_all_lights
  mode: single
- id: '1755658280925'
  alias: Sync TV and heat with lights
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - light.theatre
    to: 'on'
    from: 'off'
    id: turn_on
  - trigger: state
    entity_id:
    - light.theatre
    from: 'on'
    to: 'off'
    id: turn_off
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - turn_on
      - condition: sun
        after: sunset
      sequence:
      - action: media_player.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: media_player.android_tv
        enabled: false
      - if:
        - condition: state
          entity_id: climate.theatre_thermostat
          attribute: preset_mode
          state: none
        then:
        - action: climate.set_temperature
          metadata: {}
          data:
            temperature: 21.5
          target:
            area_id: theatre
        alias: Crank up heat
    - conditions:
      - condition: trigger
        id:
        - turn_off
      sequence:
      - action: media_player.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: media_player.android_tv
        enabled: false
      - alias: Turn down heat
        if:
        - condition: state
          entity_id: climate.theatre_thermostat
          attribute: preset_mode
          state: none
        then:
        - action: climate.set_temperature
          metadata: {}
          data:
            temperature: 20
          target:
            area_id: theatre
  mode: single
- id: '1755658699501'
  alias: Motion (5 min before sunset, 1h after)
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.motion_remote
    to: 'on'
    from: 'off'
    id: motion
  - trigger: state
    entity_id:
    - light.bedroom_2
    to: 'on'
    id: lights_on
  conditions:
  - condition: time
    before: 02:00:00
    after: 08:00:00
  - condition: or
    conditions:
    - condition: trigger
      id:
      - lights_on
    - condition: state
      entity_id: light.bedroom_2
      state: 'off'
      for:
        hours: 0
        minutes: 0
        seconds: 30
    - condition: state
      entity_id: light.bedroom_2
      state: 'on'
  - alias: If not everybody is sleeping
    condition: not
    conditions:
    - condition: and
      conditions:
      - condition: state
        entity_id: sensor.eric_phone_battery_state
        state: charging
      - condition: state
        entity_id: sensor.caro_phone_battery_state
        state: charging
  actions:
  - if:
    - condition: time
      after: '18:00:00'
      before: 02:00:00
    - condition: state
      entity_id: sensor.caro_phone_battery_state
      state: charging
    then:
    - if:
      - condition: state
        entity_id: light.bedroom_2
        state: 'off'
      then:
      - action: light.turn_on
        metadata: {}
        data:
          transition: 5
          brightness_pct: 22
        target:
          entity_id: light.eric_bedside_table
    else:
    - sequence:
      - if:
        - condition: trigger
          id:
          - motion
        - condition: state
          entity_id: light.bedroom_2
          state: 'off'
        then:
        - action: hue.activate_scene
          metadata: {}
          data:
            dynamic: true
            transition: 1
          target:
            entity_id: scene.bedroom_natural_light
      - choose:
        - conditions:
          - condition: sun
            before: sunset
            after: sunrise
          sequence:
          - delay:
              hours: 0
              minutes: 5
              seconds: 0
              milliseconds: 0
        default:
        - delay:
            hours: 1
            minutes: 0
            seconds: 0
            milliseconds: 0
      - action: light.turn_off
        metadata: {}
        data:
          transition: 5
        target:
          area_id: bedroom
  mode: restart
- id: '1755663821309'
  alias: Motion on
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.theatre_motion_sensor
    to: 'on'
    from: 'off'
  conditions:
  - condition: time
    before: '23:30:00'
    after: 07:30:00
  - condition: state
    entity_id: light.theatre
    state: 'off'
  actions:
  - action: hue.activate_scene
    metadata: {}
    data:
      dynamic: true
      transition: 1
    target:
      entity_id: scene.theatre_natural_light_2
  mode: single
- id: '1755722221689'
  alias: Away mode
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.anybody
    to:
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: state
        entity_id: binary_sensor.anybody
        state: 'on'
      sequence:
      - action: automation.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: '{{ label_entities(''motions'') }}'
    - conditions:
      - condition: state
        entity_id: binary_sensor.anybody
        state: 'off'
      sequence:
      - action: automation.turn_off
        metadata: {}
        data:
          stop_actions: true
        target:
          entity_id: '{{ label_entities(''motions'') }}'
      - action: script.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: script.turn_off_all_lights
  mode: single
- id: '1755723366418'
  alias: Hidden 3-buttons remote
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.motion_remote_left_button
    id: left_button
    to: 'on'
  - trigger: state
    entity_id:
    - binary_sensor.motion_remote_middle_button
    to: 'on'
    id: middle_button
  - trigger: state
    entity_id:
    - binary_sensor.motion_remote_right_button
    to: 'on'
    id: right_button
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - left_button
      sequence:
      - wait_for_trigger:
        - trigger: state
          entity_id:
          - binary_sensor.motion_remote_left_button
          to:
          - 'off'
        timeout:
          hours: 0
          minutes: 0
          seconds: 0
          milliseconds: 700
        continue_on_timeout: true
      - if:
        - condition: template
          value_template: '{{ wait.completed }}'
        then:
        - action: script.turn_on
          metadata: {}
          data: {}
          target:
            entity_id: script.turn_off_things_before_sleeping
        else:
        - action: script.turn_on
          metadata: {}
          data: {}
          target:
            entity_id: script.turn_off_all_lights
    - conditions:
      - condition: trigger
        id:
        - middle_button
      sequence:
      - if:
        - condition: state
          entity_id: light.eric_bedside_table
          state:
          - 'off'
        then:
        - action: light.turn_on
          metadata: {}
          data:
            brightness_pct: 1
            transition: 1
          target:
            entity_id: light.eric_bedside_table
        else:
        - action: light.turn_on
          metadata: {}
          data:
            brightness_pct: 100
            transition: 1
          target:
            entity_id: light.eric_bedside_table
    - conditions:
      - condition: trigger
        id:
        - right_button
      sequence:
      - if:
        - condition: state
          entity_id: light.bedroom_2
          state:
          - 'off'
        then:
        - action: hue.activate_scene
          metadata: {}
          data:
            transition: 1
            dynamic: true
          target:
            entity_id: scene.bedroom_natural_light
        else:
        - action: light.turn_on
          metadata: {}
          data:
            transition: 1
            brightness_pct: 100
          target:
            area_id: bedroom
  mode: parallel
  max: 10
- id: '1756351726973'
  alias: Motion off after 45min after sunset
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.theatre_motion_sensor
    to: 'off'
    for:
      hours: 0
      minutes: 45
      seconds: 0
  - trigger: state
    entity_id:
    - media_player.cast_tv
    from:
    - playing
    for:
      hours: 0
      minutes: 45
      seconds: 0
  conditions:
  - condition: sun
    after: sunset
    before: sunrise
  - condition: state
    entity_id: binary_sensor.theatre_motion_sensor
    state: 'off'
    for:
      hours: 0
      minutes: 45
      seconds: 0
  - condition: or
    conditions:
    - condition: state
      entity_id: media_player.cast_tv
      state: 'off'
    - condition: state
      entity_id: media_player.cast_tv
      state: idle
  actions:
  - action: light.turn_off
    metadata: {}
    data:
      transition: 5
    target:
      area_id: theatre
  mode: single
- id: '1757204962690'
  alias: Show outside temperature on thermostats
  description: ''
  use_blueprint:
    path: ericmatte/climate_outdoor_temperature.yaml
    input:
      temperature_input: weather.home
      thermostats:
      - 6cac62494ac9c1f73ab0bab89f83e3d2
      - 83eb981d39bcce2114b24b1630994074
      - ae632394cc0506da5e99eed1e5885bc0
      - 54e5c6a92f5b996aeb4875a3fce1f411
      - b0f91e9fca55faafdfaa7d489d4794fd
- id: '1757464460111'
  alias: Motion
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.motion_presence
    to: 'on'
  conditions:
  - condition: state
    entity_id: person.eric
    state: home
  - condition: state
    entity_id: light.office
    state: 'off'
    for:
      hours: 0
      minutes: 0
      seconds: 30
    enabled: true
  - condition: time
    after: 06:00:00
    before: '23:30:00'
  actions:
  - action: light.turn_on
    metadata: {}
    data:
      transition: 1
    target:
      entity_id: light.office
  mode: single
- id: '1757464873639'
  alias: Sync auxiliary light with main light
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - light.office
    to:
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: state
        entity_id: light.office
        state: 'on'
      sequence:
      - action: hue.activate_scene
        metadata: {}
        data:
          transition: 1
        target:
          entity_id: scene.eric_office_cool_bright
    default:
    - action: light.turn_off
      metadata: {}
      data:
        transition: 1
      target:
        entity_id: light.auxiliary_lamp
  mode: single
- id: '1758113303096'
  alias: Sync box toggle
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - input_select.sync_box_settings
    to:
  - trigger: state
    entity_id:
    - media_player.cast_tv
    to:
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: or
        conditions:
        - condition: and
          conditions:
          - condition: state
            entity_id: input_select.sync_box_settings
            state: On while playing TV
          - condition: state
            entity_id: media_player.cast_tv
            state: playing
        - condition: state
          entity_id: input_select.sync_box_settings
          state: 'On'
      sequence:
      - action: light.turn_on
        metadata: {}
        data:
          brightness_pct: 75
        target:
          entity_id: light.sync_box
    default:
    - action: light.turn_off
      metadata: {}
      data: {}
      target:
        entity_id: light.sync_box
  mode: single
- id: '1758600795981'
  alias: Sync box reset
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - media_player.cast_tv
    to: 'off'
  conditions:
  - condition: state
    entity_id: input_select.sync_box_settings
    state: 'On'
  actions:
  - action: input_select.select_option
    metadata: {}
    data:
      option: On while playing TV
    target:
      entity_id: input_select.sync_box_settings
  mode: single
- id: '1758678147252'
  alias: Sump leak alarm notification
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.sump_water_leak_detector_water_leak
    to: 'on'
  conditions: []
  actions:
  - action: notify.notify
    metadata: {}
    data:
      title: "⚠️ Augmentation du niveau d'eau! \U0001F4A6"
      message: Dans le puisard
      data:
        ttl: 0
        priority: high
  mode: single
- id: '1758678867687'
  alias: Dishwasher leak alarm notification
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.dishwasher_leak_detector_water_leak
    to: 'on'
  conditions: []
  actions:
  - action: notify.notify
    metadata: {}
    data:
      title: "⚠️ Fuite a été détecté! \U0001F4A6"
      message: Au lave-vaisselle
      data:
        ttl: 0
        priority: high
  mode: single
- id: '1759028691915'
  alias: Laundry light on when door opens
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.laundry_door
    to:
  conditions: []
  actions:
  - if:
    - condition: state
      entity_id: binary_sensor.laundry_door
      state: 'on'
    then:
    - action: light.turn_on
      metadata: {}
      data: {}
      target:
        entity_id: light.laundry
    else:
    - action: light.turn_off
      metadata: {}
      data: {}
      target:
        entity_id: light.laundry
  mode: single
- id: '1759029939032'
  alias: Lights on when arriving or opening the door
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.front_door
    to: 'on'
    id: door
  - trigger: state
    entity_id:
    - person.eric
    - person.caro
    to: home
    id: a person
  conditions:
  - condition: sun
    before: sunrise
    after: sunset
    after_offset: -01:00:00
  actions:
  - action: light.turn_on
    metadata: {}
    data:
      transition: 2
    target:
      entity_id:
      - light.entrance_lights
      - light.driveway_lantern
  - if:
    - condition: trigger
      id:
      - a person
    then:
    - action: light.turn_on
      metadata: {}
      data:
        transition: 2
      target:
        area_id:
        - entrance
  - delay:
      hours: 0
      minutes: 5
      seconds: 0
      milliseconds: 0
  - action: light.turn_off
    metadata: {}
    data:
      transition: 2
    target:
      entity_id:
      - light.entrance_lights
      - light.driveway_lantern
  mode: restart
- id: '1759083438717'
  alias: Warn when below 0°C
  description: ''
  triggers:
  - trigger: numeric_state
    entity_id:
    - sensor.workshop_temperature_humidity_temperature
    below: 0
  conditions: []
  actions:
  - action: notify.notify
    metadata: {}
    data:
      message: La température dans l'établie est en dessous de 0°C. Il est temps de
        rentrer du stock.
      title: "\U0001F321️ Avertissement de temperature \U0001F976"
  mode: single
- id: '1759255356717'
  alias: High humidity alert
  description: ''
  use_blueprint:
    path: ericmatte/humidity_high_alert.yaml
    input:
      humidity_sensors:
      - sensor.rm4_humidity
      - sensor.motion_humidity
      - sensor.workshop_temperature_humidity_humidity
      threshold: 65
- id: '1759267988873'
  alias: Sync covers with time and sun
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - sun.sun
    to: below_horizon
    id: Sun below horizon
  - trigger: time
    at: 09:30:00
    id: Time in the morning
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - Time in the morning
      sequence:
      - action: cover.open_cover
        metadata: {}
        data: {}
        target:
          area_id:
          - dining_room
      - if:
        - condition: state
          entity_id: input_boolean.guest_mode
          state:
          - 'off'
        then:
        - action: cover.open_cover
          metadata: {}
          data: {}
          target:
            area_id:
            - guest_room
    - conditions:
      - condition: trigger
        id:
        - Sun below horizon
      sequence:
      - action: cover.close_cover
        metadata: {}
        data: {}
        target:
          floor_id:
          - first_floor
          - basement
  mode: single
- id: '1759287649594'
  alias: Sync kitchen lights
  description: ''
  use_blueprint:
    path: ericmatte/lights_sync.yaml
    input:
      lights:
      - light.kitchen_island_lights
      - light.kitchen_sink_lights
      - light.kitchen_middle_light
- id: '1759336603445'
  alias: Turn off light after 30min before sunset
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - light.kitchen_island_lights
    to: 'on'
    for:
      hours: 0
      minutes: 30
      seconds: 0
  conditions:
  - condition: time
    before: 04:00:00
  actions:
  - action: light.turn_off
    metadata: {}
    data: {}
    target:
      area_id: kitchen
  mode: single
- id: '1759450285307'
  alias: Lights off after 1h30am
  description: ''
  triggers:
  - trigger: time
    at: 01:30:00
  conditions:
  - condition: state
    entity_id: light.outside_outlet
    state: 'on'
  actions:
  - action: light.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: light.outside_outlet
  mode: single
- id: '1759495948382'
  alias: Open curtains when lights are turned on in the morning
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - light.kitchen_middle_light
    to: 'on'
  conditions:
  - condition: time
    after: 07:00:00
    before: '10:00:00'
  actions:
  - action: cover.open_cover
    metadata: {}
    data: {}
    target:
      area_id: dining_room
  mode: single
- id: '1759638483935'
  alias: Turn up heat while lights are on
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - light.office
    from: 'off'
    to: 'on'
    id: Turn on
  - trigger: state
    entity_id:
    - light.office
    from: 'on'
    to: 'off'
    for:
      hours: 0
      minutes: 15
      seconds: 0
    id: Off for 15 min
  conditions:
  - condition: state
    entity_id: person.eric
    state: home
  - condition: time
    weekday:
    - mon
    - tue
    - wed
    - thu
    - fri
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - Turn on
      sequence:
      - action: climate.set_temperature
        metadata: {}
        data:
          temperature: 21
        target:
          area_id: eric_office
    - conditions:
      - condition: trigger
        id:
        - Off for 15 min
      sequence:
      - action: climate.set_temperature
        metadata: {}
        data:
          temperature: 19.5
        target:
          area_id: eric_office
  mode: single
- id: '1760366605928'
  alias: Smart heat controller
  description: ''
  use_blueprint:
    path: ericmatte/smart_heating_controller.yaml
    input:
      use_target_until: '23:59:59'
      heat_pump: climate.heat_pump
      aux_thermostats:
      - climate.living_room_thermostat
      - climate.dining_room_thermostat
      outside_temp_sensor: sensor.outside_temperature
      min_outside_temp: -12
      target_temp: 21
      away_night_temp: 18
      anybody_home: binary_sensor.anybody
      use_target_from: 06:00:00
      fan_mode: auto
- id: '1760485855717'
  alias: Light on when opening workshop door
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.door_sensor_contact
    to: 'on'
  conditions: []
  actions:
  - action: light.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: light.office
  mode: single
- id: '1760535371073'
  alias: Motion off after 5min before sunset
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.theatre_motion_sensor
    to: 'off'
    for:
      hours: 0
      minutes: 5
      seconds: 0
  - trigger: state
    entity_id:
    - media_player.cast_tv
    from:
    - playing
    for:
      hours: 0
      minutes: 5
      seconds: 0
  conditions:
  - condition: sun
    after: sunrise
    before: sunset
  - condition: state
    entity_id: binary_sensor.theatre_motion_sensor
    state: 'off'
    for:
      hours: 0
      minutes: 5
      seconds: 0
  - condition: not
    conditions:
    - condition: state
      entity_id: media_player.cast_tv
      state: playing
  actions:
  - action: light.turn_off
    metadata: {}
    data:
      transition: 5
    target:
      area_id: theatre
  mode: single
- id: '1760560959850'
  alias: Send notification if a door opens when away
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.front_door
    - binary_sensor.door_sensor_contact
    to: 'on'
  conditions:
  - condition: state
    entity_id: binary_sensor.anybody
    state: 'off'
  actions:
  - action: notify.notify
    metadata: {}
    data:
      message: Une porte a été ouverte pendant notre absence
      data:
        ttl: 0
        priority: high
      title: "\U0001F6AA Door opened"
  mode: single
- id: '1760581910388'
  alias: Turn off almost every thing before going to bed
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - sensor.eric_phone_battery_state
    to: charging
    id: charger
  conditions:
  - condition: time
    after: '22:00:00'
    before: 02:00:00
  actions:
  - action: script.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: script.turn_off_things_before_sleeping
  mode: single
- id: '1760614449167'
  alias: Morning heat
  description: ''
  triggers:
  - trigger: time
    at: 06:30:00
    id: Morning starts
  - trigger: time
    at: 09:45:00
    id: Morning ends
  conditions:
  - condition: state
    entity_id: binary_sensor.anybody
    state: 'on'
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - Morning starts
      sequence:
      - action: climate.set_temperature
        metadata: {}
        data:
          temperature: 22
        target:
          area_id: bedroom
    - conditions:
      - condition: trigger
        id:
        - Morning ends
      sequence:
      - action: climate.set_temperature
        metadata: {}
        data:
          temperature: 19.5
        target:
          area_id: bedroom
  mode: single
- id: '1760675329567'
  alias: Motion
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.motion_light_occupancy
    to: 'on'
  conditions:
  - condition: state
    entity_id: binary_sensor.everybody_is_sleeping
    state: 'off'
  actions:
  - if:
    - condition: sun
      before: sunset
      after: sunrise
    then:
    - action: light.turn_on
      metadata: {}
      data:
        transition: 1
        brightness_pct: 100
      target:
        entity_id: light.hallway_lights
    else:
    - action: light.turn_on
      metadata: {}
      data:
        transition: 1
        brightness_pct: 70
      target:
        entity_id: light.hallway_lights
    - action: light.turn_on
      metadata: {}
      data:
        transition: 1
        color_temp_kelvin: 2700
      target:
        entity_id: light.motion_light
  - delay:
      hours: 0
      minutes: 5
      seconds: 0
      milliseconds: 0
  - action: light.turn_off
    metadata: {}
    data:
      transition: 3
    target:
      entity_id:
      - light.hallway_lights
  - delay:
      hours: 0
      minutes: 2
      seconds: 0
      milliseconds: 0
  - action: light.turn_off
    metadata: {}
    data:
      transition: 3
    target:
      entity_id:
      - light.motion_light
  mode: restart
- id: '1761237786458'
  alias: Button
  description: ''
  triggers:
  - domain: mqtt
    device_id: 8317fbc3ea314ec40186f0d8ec39998d
    type: action
    subtype: single
    trigger: device
    id: single press
  - domain: mqtt
    device_id: 8317fbc3ea314ec40186f0d8ec39998d
    type: action
    subtype: double
    trigger: device
    id: double press
  - domain: mqtt
    device_id: 8317fbc3ea314ec40186f0d8ec39998d
    type: action
    subtype: long
    trigger: device
    id: long press
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - single press
      sequence:
      - action: scene.turn_on
        metadata: {}
        data:
          transition: 0
        target:
          entity_id: scene.red_warning
      - alias: Tell a story
        sequence:
        - action: media_player.volume_set
          metadata: {}
          data:
            volume_level: 0.75
          target:
            entity_id: media_player.sonos
        - action: tts.speak
          metadata: {}
          data:
            cache: true
            media_player_entity_id: media_player.sonos
            message: 'Warning: self-destruct feature enabled. Please exit the perimeter
              before countdown. 5, 4, 3, 2, 1, bam!'
            language: en-US
          target:
            entity_id: tts.home_assistant_cloud
        - action: tts.speak
          metadata: {}
          data:
            cache: true
            media_player_entity_id: media_player.sonos
            language: fr-CA
            message: Vous avez enclenché le mode d'auto destruction. Auto destruction
              dans 5, 4, 3, 2, 1
          target:
            entity_id: tts.home_assistant_cloud
          enabled: false
        - action: tts.speak
          metadata: {}
          data:
            cache: true
            media_player_entity_id: media_player.sonos
            message: Il était une fois l'histoire d'une personne très spécial qui
              pèsa sur le mystérieux bouton. Cette personne se trouvait dans l'entrée
              de la maison, à jaser avec ses amis, lorsque tout à coup, elle aperceva
              ce mystérieux bouton. Rempli de curiosité, la personne cliqua sur le
              bouton, et entendu son histoire se dérouler devant elle. C'était, il
              faut se le dire, toute qu'une histoire! Et maintenant, et oui, c'est
              déjà la fin de cette magnifique histoire. Fin!
            language: fr-CA
          target:
            entity_id: tts.home_assistant_cloud
          enabled: false
        enabled: true
      - delay:
          hours: 0
          minutes: 0
          seconds: 5
          milliseconds: 500
      - action: light.turn_on
        metadata: {}
        data:
          transition: 4
          brightness_pct: 100
        target:
          area_id: entrance
      - delay:
          hours: 0
          minutes: 0
          seconds: 4
          milliseconds: 0
      - repeat:
          count: 3
          sequence:
          - action: light.toggle
            metadata: {}
            data:
              brightness_pct: 100
              transition: 0
            enabled: true
            target:
              area_id: entrance
          - delay:
              hours: 0
              minutes: 0
              seconds: 0
              milliseconds: 500
      - action: scene.turn_on
        metadata: {}
        data:
          transition: 2
        target:
          entity_id: scene.living_lights
    - conditions:
      - condition: trigger
        id:
        - double press
      sequence:
      - action: script.turn_off_all_lights
        metadata: {}
        data: {}
    - conditions:
      - condition: trigger
        id:
        - long press
      sequence:
      - action: light.toggle
        metadata: {}
        data: {}
        target:
          area_id:
          - entrance
          - downstairs_hallway
  mode: single
- id: '1761456373751'
  alias: Sync front yard lights
  description: ''
  use_blueprint:
    path: ericmatte/lights_sync.yaml
    input:
      lights:
      - light.entrance_lights
      - light.driveway_lantern
- id: '1762225891240'
  alias: Diva remote
  description: ''
  triggers:
  - device_id: 903e93bc8a512f17c3c5959bd5f879c5
    domain: lutron_caseta
    type: press
    subtype: 'on'
    trigger: device
    id: 'On'
  - device_id: 903e93bc8a512f17c3c5959bd5f879c5
    domain: lutron_caseta
    type: press
    subtype: 'off'
    trigger: device
    id: 'Off'
  conditions: []
  actions:
  - if:
    - condition: state
      entity_id: light.rgbw_dimmer
      state: 'off'
    then:
    - sequence:
      - action: light.turn_on
        metadata: {}
        data:
          brightness_pct: 100
          rgbw_color:
          - 130
          - 59
          - 0
          - 255
          transition: 1
        target:
          area_id: upstairs_bathroom
      - delay:
          hours: 1
          minutes: 0
          seconds: 0
          milliseconds: 0
      - action: light.turn_off
        metadata: {}
        data:
          transition: 4
        target:
          area_id: upstairs_bathroom
    else:
    - action: light.turn_off
      metadata: {}
      data:
        transition: 1
      target:
        area_id: upstairs_bathroom
  - choose:
    - conditions:
      - condition: trigger
        id:
        - 'On'
      sequence:
      - sequence:
        - action: light.turn_on
          metadata: {}
          data:
            brightness_pct: 100
            rgbw_color:
            - 255
            - 180
            - 180
            - 255
            transition: 1
          target:
            area_id: upstairs_bathroom
        - delay:
            hours: 1
            minutes: 0
            seconds: 0
            milliseconds: 0
        - action: light.turn_off
          metadata: {}
          data:
            transition: 4
          target:
            area_id: upstairs_bathroom
    - conditions:
      - condition: trigger
        id:
        - 'Off'
      sequence:
      - action: light.turn_off
        metadata: {}
        data:
          transition: 1
        target:
          area_id: upstairs_bathroom
    enabled: false
  mode: restart
- id: '1762286686732'
  alias: Motion
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.motion_presence
    to: 'on'
  conditions:
  - condition: state
    entity_id: binary_sensor.everybody_is_sleeping
    state: 'off'
  actions:
  - action: light.turn_on
    metadata: {}
    data:
      transition: 1
      brightness_pct: 100
    target:
      area_id: downstairs_hallway
  - wait_for_trigger:
    - trigger: state
      entity_id:
      - binary_sensor.motion_presence
      from:
      - 'on'
    continue_on_timeout: true
  - delay:
      hours: 0
      minutes: 1
      seconds: 30
      milliseconds: 0
  - action: light.turn_off
    metadata: {}
    data:
      transition: 3
    target:
      area_id: downstairs_hallway
  mode: restart
- id: '1762781357660'
  alias: Lights on in the morning
  description: ''
  triggers:
  - type: turned_on
    device_id: c4fef1df9188b781a5a2676d3db745ed
    entity_id: d305f15d3ad2a8e3538438c86e3cf451
    domain: light
    trigger: device
  conditions:
  - condition: time
    after: 07:30:00
    before: 09:30:00
  actions:
  - action: light.turn_on
    metadata: {}
    data: {}
    target:
      area_id:
      - living_room
      - kitchen
      - entrance
  mode: single
- id: '1763751075796'
  alias: Toggle curtains
  description: ''
  triggers:
  - domain: mqtt
    device_id: 0342a9d7194bbed06bb7b85d9e19d8e1
    type: action
    subtype: single
    trigger: device
  - domain: mqtt
    device_id: 0342a9d7194bbed06bb7b85d9e19d8e1
    type: action
    subtype: hold
    trigger: device
  - domain: mqtt
    device_id: 0342a9d7194bbed06bb7b85d9e19d8e1
    type: action
    subtype: double
    trigger: device
  conditions: []
  actions:
  - action: cover.toggle
    metadata: {}
    data: {}
    target:
      area_id: guest_room
  mode: single
- id: '1763752383288'
  alias: Motion
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.bathroom_motion
    to:
    - 'on'
  conditions:
  - condition: state
    entity_id: binary_sensor.everybody_is_sleeping
    state: 'off'
  actions:
  - action: light.turn_on
    metadata: {}
    data:
      transition: 1
      brightness_pct: 100
    target:
      area_id: upstairs_bathroom
  - delay:
      hours: 0
      minutes: 45
      seconds: 0
      milliseconds: 0
  - action: light.turn_off
    metadata: {}
    data:
      transition: 3
    target:
      area_id:
      - upstairs_bathroom
  mode: restart
- id: '1763753055069'
  alias: Shower leak detector
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.shower_leak_detector_water_leak
    to:
    - 'on'
  conditions: []
  actions:
  - action: notify.notify
    metadata: {}
    data:
      title: "⚠️ Douche: Fuite détecté! \U0001F4A6"
      message: La douche en bas coule sur le côté. À vérifier.
      data:
        ttl: 0
        priority: high
  mode: single
- id: '1763754630684'
  alias: Lights on when making coffee
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.kitchen_door_sensor_contact
    to:
    - 'on'
  conditions: []
  actions:
  - action: light.turn_on
    metadata: {}
    data:
      transition: 1
      brightness_pct: 100
    target:
      area_id: kitchen
  mode: single
- id: '1763756468607'
  alias: In vibration turn on lights
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.vibration_sensor_vibration
    to:
    - 'on'
  conditions:
  - condition: state
    entity_id: binary_sensor.everybody_is_sleeping
    state:
    - 'off'
  - condition: time
    after: '15:00:00'
    before: '23:30:00'
  actions:
  - action: light.turn_on
    metadata: {}
    data:
      brightness_pct: 100
    target:
      area_id:
      - dining_room
      - living_room
  mode: single
